// ğŸ§ª P2PBoxåŸºæœ¬æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ
// IntentBoxã¨P2PBoxã®åŸºæœ¬çš„ãªå‹•ä½œã‚’æ¤œè¨¼

print("=== P2PBox Basic Test ===")

// 1. IntentBoxã®ä½œæˆ
print("\n1. Creating IntentBox...")
local world
world = new IntentBox()
print("âœ… IntentBox created: " + world.type())

// 2. P2PBoxãƒãƒ¼ãƒ‰ã®ä½œæˆ
print("\n2. Creating P2PBox nodes...")
local alice
local bob
local charlie

alice = new P2PBox("alice", world)
bob = new P2PBox("bob", world)
charlie = new P2PBox("charlie", world)

print("âœ… Alice created: " + alice.getNodeId())
print("âœ… Bob created: " + bob.getNodeId())
print("âœ… Charlie created: " + charlie.getNodeId())

// 3. ãƒªã‚¹ãƒŠãƒ¼ç™»éŒ²ãƒ†ã‚¹ãƒˆ
print("\n3. Testing listener registration...")
bob.on("greeting", "bob_greeting_handler")
charlie.on("greeting", "charlie_greeting_handler")
print("âœ… Listeners registered")

// 4. ç›´æ¥é€ä¿¡ãƒ†ã‚¹ãƒˆ
print("\n4. Testing direct send...")
alice.send("greeting", "Hello Bob!", "bob")
alice.send("greeting", "Hello Charlie!", "charlie")
print("âœ… Messages sent")

// 5. ãƒ–ãƒ­ãƒ¼ãƒ‰ã‚­ãƒ£ã‚¹ãƒˆãƒ†ã‚¹ãƒˆ
print("\n5. Testing broadcast...")
alice.broadcast("announcement", "Hello everyone!")
print("âœ… Broadcast sent")

// 6. ãƒªã‚¹ãƒŠãƒ¼è§£é™¤ãƒ†ã‚¹ãƒˆ
print("\n6. Testing listener removal...")
local result
result = bob.off("greeting")
print("âœ… Bob's listener removed: " + result)

// 7. è§£é™¤å¾Œã®é€ä¿¡ãƒ†ã‚¹ãƒˆ
print("\n7. Testing send after listener removal...")
alice.send("greeting", "Hello again Bob!", "bob")
print("âœ… Message sent (Bob should not receive)")

// 8. è¤‡æ•°ãƒªã‚¹ãƒŠãƒ¼ãƒ†ã‚¹ãƒˆ
print("\n8. Testing multiple listeners...")
charlie.on("data", "charlie_data_handler1")
charlie.on("data", "charlie_data_handler2")
alice.send("data", "Test data", "charlie")
print("âœ… Multiple listeners tested")

print("\n=== Test Complete ===")