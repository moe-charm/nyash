// 3つの引数テスト - リテラル値のみ

print("=== Three Args Literal Test ===")

// Hub側 - 3つの引数を受け取る
box MessageHub {
    init { name }
    
    process(messageType, data, from) {
        print("MessageHub processing: " + from + " -> " + messageType + " = " + data)
    }
}

// Node側
box PeerNode {
    init { nodeId, hub }
    
    setup(id, hubRef) {
        me.nodeId = id
        me.hub = hubRef
        print("PeerNode setup: " + id)
    }
    
    send(messageType, data) {
        print("PeerNode sending: " + messageType)
        // me.nodeId の代わりにリテラル値を使用
        me.hub.process(messageType, data, "LiteralSender")
    }
}

print("Creating MessageHub...")
local hub
hub = new MessageHub()

print("Creating PeerNode...")
local node
node = new PeerNode()
node.setup("TestNode", hub)

print("Sending message...")
node.send("hello", "Hi there!")

print("Test completed!")