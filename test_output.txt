ğŸ” DEBUG: Initializing v2 plugin system
[net] Net plugin initialized, LOG_ON=true, LOG_PATH=net_plugin.log
Net plugin: LOG_ON=true, LOG_PATH=net_plugin.log
[PluginLoaderV2] nyash_plugin_init rc=0 for libnyash_net_plugin.so
[PluginLoaderV2] nyash_plugin_init rc=0 for libnyash_counter_plugin.so
[FileBox] Plugin initialized
[PluginLoaderV2] nyash_plugin_init rc=0 for libnyash_filebox_plugin.so
ğŸ”Œ v2 plugin system initialized from nyash.toml
  ğŸ“¦ Registering plugin provider for HttpServerBox
  ğŸ“¦ Registering plugin provider for HttpClientBox
  ğŸ“¦ Registering plugin provider for HttpResponseBox
  ğŸ“¦ Registering plugin provider for HttpRequestBox
  ğŸ“¦ Registering plugin provider for SocketServerBox
  ğŸ“¦ Registering plugin provider for SocketClientBox
  ğŸ“¦ Registering plugin provider for SocketConnBox
  ğŸ“¦ Registering plugin provider for CounterBox
  ğŸ“¦ Registering plugin provider for FileBox
âœ… v2 plugin system fully configured
ğŸ¦€ Nyash Rust Implementation - Executing file: local_tests/test_http_simple_e2e.nyash ğŸ¦€
ğŸ”¥ Debug fuel limit: 100000 iterations
====================================================
ğŸ“ File contents:
// Very simple HTTP test
local srv, cli, r, resp
srv = new HttpServerBox()
print("HttpServerBox created")

// Start server
local startResult = srv.start(8090)
print("Server start result:")
print(startResult)

// Create client
cli = new HttpClientBox()
print("HttpClientBox created")

// Make request
r = cli.get("http://localhost:8090/test")
print("Request made")

// Accept connection
local acceptResult = srv.accept()
print("Accept result:")
print(acceptResult)

// Get value from accept result
local req = acceptResult.get_value()
print("Got request value")

// Create response
resp = new HttpResponseBox()
resp.write("Hello!")
print("Response created and written")

// Send response
req.respond(resp)
print("Response sent")

// Get response on client side
local clientResp = r.get_value()
print("Got client response")

// Read body
local body = clientResp.readBody()
print("Body: " + body)

ğŸš€ Parsing and executing...

ğŸ” DEBUG: Starting parse with fuel: Some(100000)...
ğŸ” DEBUG: Parse completed, AST created
ğŸ” DEBUG: About to print parse success message...
âœ… Parse successful!
ğŸ” DEBUG: Parse success message printed
ğŸ” DEBUG: Creating interpreter...
ğŸ” DEBUG: Starting execution...
ğŸ” create_box called for: HttpServerBox
ğŸ” Config loaded successfully
ğŸ” Found library: libnyash_net_plugin.so for box type: HttpServerBox
ğŸ” Plugin loaded successfully
ğŸ” Reading nyash.toml for type configuration...
ğŸ” nyash.toml read successfully
ğŸ” nyash.toml parsed successfully
ğŸ” Found box config for HttpServerBox with type_id: 20
ğŸ” Preparing to call birth() with type_id: 20
ğŸ” Output buffer allocated, about to call plugin invoke_fn...
ğŸ” Calling invoke_fn(type_id=20, method_id=0, instance_id=0, tlv_args=[1, 0, 0, 0], output_buf, output_size=1024)
ğŸ” invoke_fn returned with result: 0
ğŸ‰ birth() success: HttpServerBox instance_id=1
ğŸ” DEBUG: PluginBoxV2::share_box called for HttpServerBox (id=1)
HttpServerBox created
ğŸ” stdlib not initialized for method call
ğŸ” DEBUG: PluginBoxV2::share_box called for HttpServerBox (id=1)
ğŸ” DEBUG: execute_method_call - object type: PluginBoxV2, method: start
ğŸ” DEBUG: Checking StringBox downcast for type: PluginBoxV2
ğŸ” DEBUG: StringBox downcast failed
ğŸ” execute_plugin_box_v2_method called: HttpServerBox.start
[PluginLoaderV2] Invoke HttpServerBox.start: resolving and encoding args (argc=1)
[PluginLoaderV2]  arg[0]: Integer(8090) -> I32(tag=2)
[net] http:listener bound 127.0.0.1:8090
Server start result:
Ok(void)
ğŸ” create_box called for: HttpClientBox
ğŸ” Config loaded successfully
ğŸ” Found library: libnyash_net_plugin.so for box type: HttpClientBox
ğŸ” Plugin loaded successfully
ğŸ” Reading nyash.toml for type configuration...
ğŸ” nyash.toml read successfully
ğŸ” nyash.toml parsed successfully
ğŸ” Found box config for HttpClientBox with type_id: 23
ğŸ” Preparing to call birth() with type_id: 23
ğŸ” Output buffer allocated, about to call plugin invoke_fn...
ğŸ” Calling invoke_fn(type_id=23, method_id=0, instance_id=0, tlv_args=[1, 0, 0, 0], output_buf, output_size=1024)
ğŸ” invoke_fn returned with result: 0
ğŸ‰ birth() success: HttpClientBox instance_id=1
ğŸ” DEBUG: PluginBoxV2::share_box called for HttpClientBox (id=1)
HttpClientBox created
ğŸ” stdlib not initialized for method call
ğŸ” DEBUG: PluginBoxV2::share_box called for HttpClientBox (id=1)
ğŸ” DEBUG: execute_method_call - object type: PluginBoxV2, method: get
ğŸ” DEBUG: Checking StringBox downcast for type: PluginBoxV2
ğŸ” DEBUG: StringBox downcast failed
ğŸ” execute_plugin_box_v2_method called: HttpClientBox.get
[PluginLoaderV2] Invoke HttpClientBox.get: resolving and encoding args (argc=1)
[PluginLoaderV2]  arg[0]: String(len=26) -> String(tag=6)
[net] client.get: url=http://localhost:8090/test resp_id=1 tcp_ok=true conn_id=1
[net] http:accept linked resp_id hint=1 for req_id=1 conn_id=2
ğŸ” DEBUG: PluginBoxV2::share_box called for HttpResponseBox (id=1)
Request made
ğŸ” stdlib not initialized for method call
ğŸ” DEBUG: PluginBoxV2::share_box called for HttpServerBox (id=1)
ğŸ” DEBUG: execute_method_call - object type: PluginBoxV2, method: accept
ğŸ” DEBUG: Checking StringBox downcast for type: PluginBoxV2
ğŸ” DEBUG: StringBox downcast failed
ğŸ” execute_plugin_box_v2_method called: HttpServerBox.accept
[PluginLoaderV2] Invoke HttpServerBox.accept: resolving and encoding args (argc=0)
[net] server.accept: return req_id=1 srv_id=1
Accept result:
ğŸ” DEBUG: PluginBoxV2::share_box called for HttpRequestBox (id=1)
Ok(HttpRequestBox(1))
ğŸ” stdlib not initialized for method call
ğŸ” DEBUG: PluginBoxV2::share_box called for HttpRequestBox (id=1)
ğŸ” DEBUG: execute_method_call - object type: NyashResultBox, method: get_value
ğŸ” DEBUG: Checking StringBox downcast for type: NyashResultBox
ğŸ” DEBUG: StringBox downcast failed
ğŸ” DEBUG: PluginBoxV2::share_box called for HttpRequestBox (id=1)
ğŸ” DEBUG: PluginBoxV2::share_box called for HttpRequestBox (id=1)
Got request value
ğŸ” create_box called for: HttpResponseBox
ğŸ” Config loaded successfully
ğŸ” Found library: libnyash_net_plugin.so for box type: HttpResponseBox
ğŸ” Plugin loaded successfully
ğŸ” Reading nyash.toml for type configuration...
ğŸ” nyash.toml read successfully
ğŸ” nyash.toml parsed successfully
ğŸ” Found box config for HttpResponseBox with type_id: 22
ğŸ” Preparing to call birth() with type_id: 22
ğŸ” Output buffer allocated, about to call plugin invoke_fn...
ğŸ” Calling invoke_fn(type_id=22, method_id=0, instance_id=0, tlv_args=[1, 0, 0, 0], output_buf, output_size=1024)
ğŸ” invoke_fn returned with result: 0
ğŸ‰ birth() success: HttpResponseBox instance_id=2
ğŸ” DEBUG: PluginBoxV2::share_box called for HttpResponseBox (id=2)
ğŸ” stdlib not initialized for method call
ğŸ” DEBUG: PluginBoxV2::share_box called for HttpResponseBox (id=2)
ğŸ” DEBUG: execute_method_call - object type: PluginBoxV2, method: write
ğŸ” DEBUG: Checking StringBox downcast for type: PluginBoxV2
ğŸ” DEBUG: StringBox downcast failed
ğŸ” execute_plugin_box_v2_method called: HttpResponseBox.write
[PluginLoaderV2] Invoke HttpResponseBox.write: resolving and encoding args (argc=1)
[PluginLoaderV2]  arg[0]: String(len=6) -> String(tag=6)
[net] HttpResponse.write: id=2 bytes_len=6
[net] HttpResponse.write: body now has 6 bytes
Response created and written
ğŸ” stdlib not initialized for method call
ğŸ” DEBUG: PluginBoxV2::share_box called for HttpRequestBox (id=1)
ğŸ” DEBUG: execute_method_call - object type: PluginBoxV2, method: respond
ğŸ” DEBUG: Checking StringBox downcast for type: PluginBoxV2
ğŸ” DEBUG: StringBox downcast failed
ğŸ” execute_plugin_box_v2_method called: HttpRequestBox.respond
ğŸ” DEBUG: PluginBoxV2::share_box called for HttpResponseBox (id=2)
[PluginLoaderV2] Invoke HttpRequestBox.respond: resolving and encoding args (argc=1)
[PluginLoaderV2]  arg[0]: PluginBoxV2(HttpResponseBox, id=2) -> Handle(tag=8)
Response sent
ğŸ” stdlib not initialized for method call
ğŸ” DEBUG: PluginBoxV2::share_box called for HttpResponseBox (id=1)
ğŸ” DEBUG: execute_method_call - object type: NyashResultBox, method: get_value
ğŸ” DEBUG: Checking StringBox downcast for type: NyashResultBox
ğŸ” DEBUG: StringBox downcast failed
ğŸ” DEBUG: PluginBoxV2::share_box called for HttpResponseBox (id=1)
ğŸ” DEBUG: PluginBoxV2::share_box called for HttpResponseBox (id=1)
Got client response
ğŸ” stdlib not initialized for method call
ğŸ” DEBUG: PluginBoxV2::share_box called for HttpResponseBox (id=1)
ğŸ” DEBUG: execute_method_call - object type: PluginBoxV2, method: readBody
ğŸ” DEBUG: Checking StringBox downcast for type: PluginBoxV2
ğŸ” DEBUG: StringBox downcast failed
ğŸ” execute_plugin_box_v2_method called: HttpResponseBox.readBody
[PluginLoaderV2] Invoke HttpResponseBox.readBody: resolving and encoding args (argc=0)
