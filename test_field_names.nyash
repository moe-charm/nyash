// 特定のフィールド名テスト

print("=== Field Names Test ===")

box TargetBox {
    init { name }
    
    deliver(a, b, c) {
        print("deliver: " + a + ", " + b + ", " + c)
    }
}

// Test 1: 正常動作したフィールド名を使用
box GoodBox {
    init { target, field1 }
    
    setup(targetRef) {
        me.target = targetRef
        me.field1 = "TestValue"
        print("GoodBox setup completed")
    }
    
    test() {
        print("GoodBox: Using target and field1...")
        me.target.deliver("hello", "data", me.field1)
        print("GoodBox test completed")
    }
}

// Test 2: ハングしたフィールド名を使用
box BadBox {
    init { messageHub, nodeId }
    
    setup(targetRef) {
        me.messageHub = targetRef
        me.nodeId = "TestValue"
        print("BadBox setup completed")
    }
    
    test() {
        print("BadBox: Using messageHub and nodeId...")
        me.messageHub.deliver("hello", "data", me.nodeId)
        print("BadBox test completed")
    }
}

// テスト実行
print("Creating target...")
local target
target = new TargetBox()

print("Testing with good field names...")
local goodBox
goodBox = new GoodBox()
goodBox.setup(target)
goodBox.test()

print("Good field names worked!")

print("Testing with bad field names...")
local badBox
badBox = new BadBox()
badBox.setup(target)
badBox.test()

print("If you see this, bad field names also worked!")

print("All field name tests completed!")