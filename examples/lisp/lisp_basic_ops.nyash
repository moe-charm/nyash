// ğŸ”§ LISPåŸºæœ¬æ“ä½œé–¢æ•°å®Ÿè£…
// atom?, equal?, null? ãªã©

NIL = 0

// atom? - ã‚¢ãƒˆãƒ ï¼ˆéãƒªã‚¹ãƒˆï¼‰ã‹ã©ã†ã‹ã‚’ãƒã‚§ãƒƒã‚¯
function atomP(obj) {
    if obj == NIL { return true }  // nilã¯ã‚¢ãƒˆãƒ 
    
    // æ•°å€¤ã¯ã‚¢ãƒˆãƒ 
    if obj == 0 { return true }
    if obj == 1 { return true }
    if obj == 2 { return true }
    if obj == 3 { return true }
    if obj == 4 { return true }
    if obj == 5 { return true }
    if obj == 6 { return true }
    if obj == 7 { return true }
    if obj == 8 { return true }
    if obj == 9 { return true }
    
    // æ–‡å­—åˆ—ã¯ã‚¢ãƒˆãƒ 
    if obj == "a" { return true }
    if obj == "b" { return true }
    if obj == "c" { return true }
    if obj == "" { return true }
    if obj == "nil" { return true }
    if obj == "foo" { return true }
    if obj == "bar" { return true }
    
    // SymbolBoxã¯ã‚¢ãƒˆãƒ ï¼ˆç°¡æ˜“å®Ÿè£…ï¼‰
    // å®Ÿéš›ã«ã¯å‹ãƒã‚§ãƒƒã‚¯ãŒå¿…è¦ã ãŒã€Nyashã§ã¯é™å®šçš„
    // ConsBoxã§ãªã‘ã‚Œã°ã‚¢ãƒˆãƒ ã¨ä»®å®š
    return false  // ConsBoxä»¥å¤–ã¯å…¨ã¦ã‚¢ãƒˆãƒ æ‰±ã„
}

// equal? - æ·±ã„ç­‰ä¾¡æ€§ãƒã‚§ãƒƒã‚¯
function equalP(a, b) {
    // åŒã˜ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãªã‚‰ç­‰ä¾¡
    if a == b { return true }
    
    // nilã®ãƒã‚§ãƒƒã‚¯
    if a == NIL and b == NIL { return true }
    if a == NIL or b == NIL { return false }
    
    // ã‚¢ãƒˆãƒ åŒå£«ã®æ¯”è¼ƒ
    if atomP(a) and atomP(b) {
        return a == b
    }
    
    // ä¸¡æ–¹ãŒãƒªã‚¹ãƒˆã®å ´åˆï¼ˆå†å¸°çš„ã«æ¯”è¼ƒï¼‰
    if not atomP(a) and not atomP(b) {
        // caréƒ¨åˆ†ã‚’æ¯”è¼ƒ
        if not equalP(car(a), car(b)) {
            return false
        }
        // cdréƒ¨åˆ†ã‚’æ¯”è¼ƒ
        return equalP(cdr(a), cdr(b))
    }
    
    // ç‰‡æ–¹ãŒã‚¢ãƒˆãƒ ã€ç‰‡æ–¹ãŒãƒªã‚¹ãƒˆãªã‚‰ç­‰ä¾¡ã§ãªã„
    return false
}

// null? - nilã‹ã©ã†ã‹ã‚’ãƒã‚§ãƒƒã‚¯
function nullP(obj) {
    return obj == NIL
}

// length - ãƒªã‚¹ãƒˆã®é•·ã•ã‚’è¨ˆç®—
function lengthList(lst) {
    if lst == NIL { return 0 }
    if atomP(lst) { return 0 }  // ã‚¢ãƒˆãƒ ã¯é•·ã•0
    return 1 + lengthList(cdr(lst))
}

// append - 2ã¤ã®ãƒªã‚¹ãƒˆã‚’é€£çµ
function append(lst1, lst2) {
    if lst1 == NIL { return lst2 }
    return cons(car(lst1), append(cdr(lst1), lst2))
}

// reverse - ãƒªã‚¹ãƒˆã‚’é€†é †ã«ã™ã‚‹
function reverse(lst) {
    return reverseHelper(lst, NIL)
}

function reverseHelper(lst, acc) {
    if lst == NIL { return acc }
    return reverseHelper(cdr(lst), cons(car(lst), acc))
}

// ConsBoxã¨SymbolBoxã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆï¼ˆæ¦‚å¿µçš„ï¼‰
// å®Ÿéš›ã®ãƒ•ã‚¡ã‚¤ãƒ«ã§ã¯ include ã‚’ä½¿ç”¨ã™ã‚‹æƒ³å®š

// ãƒ†ã‚¹ãƒˆç”¨ã®ç°¡æ˜“cons/car/cdrï¼ˆä»®å®Ÿè£…ï¼‰
function cons(a, d) {
    // ConsBoxãŒåˆ©ç”¨å¯èƒ½ãªå ´åˆ
    result = "ConsBoxå®Ÿè£…ãŒå¿…è¦"
    return result
}

function car(pair) {
    if pair == NIL { return NIL }
    return "carå®Ÿè£…ãŒå¿…è¦"
}

function cdr(pair) {
    if pair == NIL { return NIL }
    return "cdrå®Ÿè£…ãŒå¿…è¦"
}

// ãƒ†ã‚¹ãƒˆ
print("=== LISP Basic Operations Test ===")
print("")

// atomP ãƒ†ã‚¹ãƒˆ
print("1. atomP tests:")
print("   atomP(42): " + atomP(42))
print("   atomP(NIL): " + atomP(NIL))
print("   atomP('hello'): " + atomP("hello"))

print("")
print("2. equalP tests:")
print("   equalP(42, 42): " + equalP(42, 42))
print("   equalP(42, 43): " + equalP(42, 43))
print("   equalP(NIL, NIL): " + equalP(NIL, NIL))
print("   equalP('a', 'a'): " + equalP("a", "a"))

print("")
print("3. nullP tests:")
print("   nullP(NIL): " + nullP(NIL))
print("   nullP(42): " + nullP(42))

print("")
print("âœ… Basic operations test done!")
print("ğŸ’¡ Next: Implement with real ConsBox integration")